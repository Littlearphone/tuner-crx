const g={fields:[],enable:!0,injectCSS:!0,injectScript:!0,configLabel:"配置开关"},k={active:!0,currentWindow:!0},u=[{id:"baidu-search",expectUrl:e=>/http(s)?:\/\/(www.)?baidu.com.*/.test(e.url),hacker:{state:"loading",style:["hack/baidu/search.css"],script:["hack/jquery.min.js","hack/common.js","hack/baidu/search.js"]},description:{enable:!0,injectCSS:!0,autoPaging:!0,injectScript:!0,configLabel:'"搜索"配置开关',fields:[{key:"autoPaging",label:"自动翻页",type:"SwitchField"}]}},{id:"baidu-zhidao",expectUrl:e=>/https?:\/\/zhidao[.]baidu[.]com\/question\/.*.html/.test(e.url),hacker:{state:"loading",style:"hack/baidu/zhidao.css",script:["hack/jquery.min.js","hack/baidu/zhidao.js"]},description:{enable:!0,injectCSS:!0,injectScript:!0,configLabel:'"知道"配置开关',fields:[]}},{id:"baidu-jingyan",expectUrl:e=>/https?:\/\/jingyan[.]baidu[.]com\/article\/.*.html/.test(e.url),hacker:{state:"loading",style:"hack/baidu/jingyan.css",script:["hack/jquery.min.js","hack/baidu/jingyan.js"]},description:{enable:!0,injectCSS:!0,injectScript:!0,configLabel:'"经验"配置开关',fields:[]}},{id:"baidu-baijiahao",expectUrl:e=>/https?:\/\/baijiahao[.]baidu[.]com\/s.*/.test(e.url),hacker:{state:"loading",style:"hack/baidu/baijiahao.css",script:["hack/jquery.min.js","hack/baidu/baijiahao.js"]},description:{enable:!0,injectCSS:!0,injectScript:!0,configLabel:'"震惊"配置开关',fields:[]}},{id:"bing-search",expectUrl:e=>/http(s)?:\/\/cn.bing.com(\/search)?.*([?&]q=.*).*/.test(e.url),hacker:{state:"loading",style:["hack/bing/search.css"],script:["hack/jquery.min.js","hack/common.js","hack/bing/search.js"]},description:{enable:!0,injectCSS:!0,enableHta:!0,autoPaging:!0,injectScript:!0,configLabel:'"搜索"配置开关',fields:[{key:"autoPaging",label:"自动翻页",type:"SwitchField"},{key:"enableHta",label:"划词翻译",type:"SwitchField"}]}},{id:"google-search",expectUrl:e=>/http(s)?:\/\/www.google.com(\/search)?.*([?&]q=.*).*/.test(e.url),hacker:{state:"loading",style:["hack/google/search.css"],script:["hack/jquery.min.js","hack/common.js","hack/google/search.js"]},description:{enable:!0,injectCSS:!0,autoPaging:!0,injectScript:!0,configLabel:'"搜索"配置开关',fields:[{key:"autoPaging",label:"自动翻页",type:"SwitchField"}]}},{id:"douyu-follow",expectUrl:e=>/http(s)?:\/\/www.douyu.com\/directory\/(myFollow|all)/.test(e.url),hacker:{state:"loading",style:"hack/douyu/live-directory.css",script:["hack/jquery.min.js","hack/douyu/live-directory.js"]},description:{enable:!0,injectCSS:!0,injectScript:!0,configLabel:'"关注"配置开关',fields:[]}},{id:"douyu-room",expectUrl:e=>/http(s)?:\/\/www.douyu.com\/([0-9]+|topic\/.*[?]rid=[0-9]+)/.test(e.url),hacker:{state:"loading",style:["hack/douyu/live-room.css"],script:["hack/jquery.min.js","hack/common.js","hack/douyu/live-room.js"]},description:{enable:!0,danMuSize:30,injectCSS:!0,injectScript:!0,fullWebScreen:!0,configLabel:'"直播"配置开关',fields:[{key:"fullWebScreen",label:"网页全屏",type:"SwitchField"},{key:"danMuSize",label:"弹幕大小",type:"SliderField",showInput:!1,step:1,min:12,max:100,marks:{24:"24",48:"48",72:"72"}}]}},{id:"bilibili-video",expectUrl:e=>/http(s)?:\/\/www.bilibili.com\/((medialist\/play\/([0-9]+|ml[0-9]+\/BV[a-zA-Z0-9]+))|(bangumi\/play\/(ep|ss)[0-9]+)|(video\/(av|BV)[a-zA-Z0-9]+))(\?.*)?/.test(e.url),hacker:{state:"loading",style:"hack/bilibili/video.css",script:["hack/jquery.min.js","hack/bilibili/video.js"]},description:{enable:!0,injectCSS:!0,playbackRate:1.25,injectScript:!0,autoStartPlay:!0,fullWebScreen:!0,configLabel:'"视频"配置开关',fields:[{key:"autoStartPlay",label:"自动播放",type:"SwitchField"},{key:"fullWebScreen",label:"网页全屏",type:"SwitchField"},{key:"playbackRate",label:"播放速率",type:"SliderField",showInput:!1,step:.05,min:.1,max:5,marks:{1:"1.0",2:"2.0",3:"3.0",4:"4.0"}}]}},{id:"pc6-software",expectUrl:e=>/https?:\/\/www[.]pc6[.]com\/softview\/SoftView_.*[.]html/.test(e.url),hacker:{state:"loading",style:"hack/pc6/software.css",script:["hack/jquery.min.js","hack/pc6/software.js"]},description:{enable:!0,injectCSS:!0,injectScript:!0,configLabel:'"应用"配置开关',fields:[]}},{id:"zhihu-question",expectUrl:e=>/https?:\/\/www[.]zhihu[.]com\/(search?.*|question\/.*)/.test(e.url),hacker:{state:"loading",style:"hack/zhihu/question.css",script:["hack/jquery.min.js","hack/zhihu/question.js"]},description:{enable:!0,injectCSS:!0,injectScript:!0,configLabel:'"问答"配置开关',fields:[]}},{id:"zhihu-zhuanlan",expectUrl:e=>/https?:\/\/zhuanlan[.]zhihu[.]com\/p\/.*/.test(e.url),hacker:{state:"loading",style:"hack/zhihu/zhuanlan.css",script:["hack/jquery.min.js","hack/zhihu/zhuanlan.js"]},description:{enable:!0,injectCSS:!0,injectScript:!0,configLabel:'"专栏"配置开关',fields:[]}},{id:"51cto-blog",expectUrl:e=>/https?:\/\/blog[.]51cto[.]com\/[0-9]+\/[0-9]+/.test(e.url),hacker:{state:"loading",style:"hack/51cto/blog.css",script:["hack/jquery.min.js","hack/51cto/blog.js"]},description:{enable:!0,injectCSS:!0,injectScript:!0,configLabel:'"博客"配置开关',fields:[]}},{id:"segmentfault-question",expectUrl:e=>/http.?:\/\/(.*[.])?segmentfault[.]com\/q\/.*/.test(e.url),hacker:{state:"loading",style:"hack/segmentfault/question.css",script:["hack/jquery.min.js","hack/segmentfault/question.js"]},description:{enable:!0,injectCSS:!0,injectScript:!0,configLabel:'"问答"配置开关',fields:[]}},{id:"segmentfault-articles",expectUrl:e=>/http.?:\/\/(.*[.])?segmentfault[.]com\/a\/.*/.test(e.url),hacker:{state:"loading",style:"hack/segmentfault/articles.css",script:["hack/jquery.min.js","hack/segmentfault/articles.js"]},description:{enable:!0,injectCSS:!0,injectScript:!0,configLabel:'"文章"配置开关',fields:[]}},{id:"cnblogs-articles",expectUrl:e=>/https?:\/\/www[.]cnblogs[.]com\/.*\/(p|articles|archive)\/.*[.]html/.test(e.url),hacker:{state:"loading",style:"hack/cnblogs/articles.css",script:["hack/jquery.min.js","hack/cnblogs/articles.js"]},description:{enable:!0,injectCSS:!0,injectScript:!0,configLabel:'"文章"配置开关',fields:[]}},{id:"iteye-magazines",expectUrl:e=>/https?:\/\/www[.]iteye[.]com\/magazines\/.*/.test(e.url),hacker:{state:"loading",style:"hack/iteye/magazines.css",script:["hack/jquery.min.js","hack/iteye/magazines.js"]},description:{enable:!0,injectCSS:!0,injectScript:!0,configLabel:'"杂志"配置开关',fields:[]}},{id:"iteye-blog",expectUrl:e=>/https?:\/\/www[.]iteye[.]com\/blog\/.*/.test(e.url),hacker:{state:"loading",style:"hack/iteye/blog.css",script:["hack/jquery.min.js","hack/iteye/blog.js"]},description:{enable:!0,injectCSS:!0,injectScript:!0,configLabel:'"博客"配置开关',fields:[]}},{id:"chinaunix-article",expectUrl:e=>/https?:\/\/blog[.]chinaunix[.]net\/.*/.test(e.url),hacker:{state:"loading",style:"hack/chinaunix/article.css",script:["hack/jquery.min.js","hack/chinaunix/article.js"]},description:{enable:!0,injectCSS:!0,injectScript:!0,configLabel:'"文章"配置开关',fields:[]}},{id:"bejson-json",expectUrl:e=>/https?:\/\/www.bejson.com\/.*/.test(e.url),hacker:{state:"loading",style:"hack/bejson/json.css",script:["hack/jquery.min.js","hack/bejson/json.js"]},description:{enable:!0,injectCSS:!0,injectScript:!0,configLabel:'"JSON"配置开关',fields:[]}},{id:"linuxidc-article",expectUrl:e=>/https?:\/\/www[.]linuxidc[.]com\/Linux\/.*[.]html?/.test(e.url),hacker:{state:"loading",style:"hack/linuxidc/article.css",script:["hack/jquery.min.js","hack/linuxidc/article.js"]},description:{enable:!0,injectCSS:!0,injectScript:!0,configLabel:'"文章"配置开关',fields:[]}},{id:"tencent-article",expectUrl:e=>/https?:\/\/cloud[.]tencent[.]com\/developer\/article\/.*/.test(e.url),hacker:{state:"loading",style:"hack/tencent/article.css",script:["hack/jquery.min.js","hack/tencent/article.js"]},description:{enable:!0,injectCSS:!0,injectScript:!0,configLabel:'"文章"配置开关',fields:[]}},{id:"jianshu-article",expectUrl:e=>/https?:\/\/www[.]jianshu[.]com\/p\/.*/.test(e.url),hacker:{state:"loading",style:"hack/jianshu/article.css",script:["hack/jquery.min.js","hack/jianshu/article.js"]},description:{enable:!0,injectCSS:!0,injectScript:!0,configLabel:'"文章"配置开关',fields:[]}},{id:"csdn-article",expectUrl:e=>/https?:\/\/(\w+[.])?blog[.]csdn[.]net\/(.*\/)?article\/details\/.*/.test(e.url),hacker:{state:"loading",style:"hack/csdn/article.css",script:["hack/jquery.min.js","hack/csdn/article.js"]},description:{enable:!0,injectCSS:!0,injectScript:!0,configLabel:'"文章"配置开关',fields:[]}},{id:"csdn-topics",expectUrl:e=>/https?:\/\/bbs[.]csdn[.]net\/topics\/.*/.test(e.url),hacker:{state:"loading",style:"hack/csdn/topics.css",script:["hack/jquery.min.js","hack/csdn/topics.js"]},description:{enable:!0,injectCSS:!0,injectScript:!0,configLabel:'"话题"配置开关',fields:[]}},{id:"7down-soft",expectUrl:e=>/https?:\/\/www[.]7down[.]com\/soft\/.*[.]html/.test(e.url),hacker:{state:"loading",style:"hack/7down/soft.css",script:["hack/jquery.min.js","hack/7down/soft.js"]},description:{enable:!0,injectCSS:!0,injectScript:!0,configLabel:'"软件"配置开关',fields:[]}},{id:"jb51-artical",expectUrl:e=>/https?:\/\/www[.]jb51[.]net\/(artical\/)?.*[.]htm(l)?/.test(e.url),hacker:{state:"loading",style:"hack/jb51/artical.css",script:["hack/jquery.min.js","hack/jb51/artical.js"]},description:{enable:!0,injectCSS:!0,injectScript:!0,configLabel:'"文章"配置开关',fields:[]}},{id:"mvcat-inject",expectUrl:e=>/https?:\/\/(www.)?mvcat[.]com\/.*/.test(e.url),hacker:{state:"loading",style:"hack/mvcat/style.css",script:["hack/jquery.min.js","hack/mvcat/script.js"]},description:{enable:!0,injectCSS:!0,injectScript:!0,configLabel:'"导航"配置开关',fields:[]}},{id:"360-article",expectUrl:e=>/https?:\/\/(www.)?360doc[.](com|cn)\/(article|content)\/.*html/.test(e.url),hacker:{state:"loading",style:"hack/360/article.css",script:["hack/jquery.min.js","hack/360/article.js"]},description:{enable:!0,injectCSS:!0,injectScript:!0,configLabel:'"文章"配置开关',fields:[]}},{id:"stackoverflow-question",expectUrl:e=>/https?:\/\/stackoverflow.com\/questions\/[0-9]+\/.*/.test(e.url),hacker:{state:"loading",style:"hack/stackoverflow/question.css",script:["hack/jquery.min.js","hack/stackoverflow/question.js"]},description:{enable:!0,injectCSS:!0,injectScript:!0,configLabel:'"问答"配置开关',fields:[]}}];function b(e,i,t){const c=e.data;fetch(c.url,{method:c.type,body:c.body}).then(async s=>t({url:c.url,status:s.status,responseURL:s.url,responseText:await s.text()})).catch(s=>t("")||console.log("跨域请求失败：",c,s))}function o(e){return typeof e=="string"?[e]:e}function l(e,i){return!e.hasOwnProperty(i)||e[i]}function h(e,i,t,c){if(!l(c,"enable")||!l(c,"injectScript"))return console.log("该页面脚本注入未启用");const s=["hack/injected.js"];(o(e.hacker.script)||[]).forEach(n=>s.push(n));const a={allFrames:!t.frameId,tabId:i};t.frameId&&(a.frameIds=[t.frameId]),chrome.scripting.executeScript({files:s,target:a,injectImmediately:!0}).then(()=>{console.log("页面脚本注入完成: ",t.url,s),p(i,Object.assign({site:e},{config:c}),n=>console.log("传递页面配置完成",n))})}function d(e,i,t,c){if(!l(c,"enable")||!l(c,"injectCSS"))return console.log("该页面样式注入未启用");const s=["hack/common.css"];(o(e.hacker.style)||[]).forEach(n=>s.push(n));const a={allFrames:!t.frameId,tabId:i};t.frameId&&(a.frameIds=[t.frameId]),chrome.scripting.insertCSS({files:s,target:a}).then(()=>console.log("页面样式注入完成: ",t.url,s))}const m=(e,i,t)=>{if(!t||!t.url||!t.url.startsWith("http://")&&!t.url.startsWith("https://"))return;const c=u.find(r=>r.expectUrl(t))||{hacker:{state:void 0},description:{enable:!1},id:new Date().toISOString()};c.id&&chrome.action.enable(e);const s=i&&i.status;c.hacker&&(s===c.hacker.state||s===!0)&&j(c.id).then(r=>{const a=Object.assign({configId:c.id},c.description,r[c.id]);console.log("页面配置获取成功: ",t.url,a),d(c,e,t,a),h(c,e,t,a)})};function p(e,i,t){chrome.tabs.sendMessage(e,i,t)}function f(e){return!e||!chrome.storage||!chrome.storage.local?new Promise(i=>i({})):chrome.storage.local.set(e)}function j(e){return!e||!chrome.storage||!chrome.storage.local?new Promise(i=>i({})):typeof e=="string"?chrome.storage.local.get([e]):(Array.isArray(e),chrome.storage.local.get(e))}export{k as A,g as D,u as H,b as a,j as g,m as p,f as s};
